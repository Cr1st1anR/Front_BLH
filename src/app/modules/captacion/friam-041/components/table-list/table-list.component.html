<app-header />


<div class="flex justify-between items-center mx-4">
  <app-new-register (nuevoRegistro)="agregarFilaVacia()" />
  <app-month-picker (dateChange)="filtrarPorFecha($event)" />
</div>


<div class="container-table">
  <p-table [value]="filteredCustomers" [scrollable]="true" scrollHeight="500px" [columns]="headersTableLineaAmiga">
    <ng-template #header let-columns>
      <tr>
        @for (col of columns; track $index) {
        @if ( col.field == "remite" || col.field == "documento") {
        <th [ngStyle]="{'background': '#F5F6FA'}" >
          <p-columnFilter type="text" field="name" placeholder="Search by name"
            ariaLabel="Filter Name"></p-columnFilter>
        </th>
        }
        @else {
        <th [attr.colspan]="col.colspan" [ngStyle]="{'background': '#F5F6FA'}"></th>
        }
        }
      </tr>
      <tr>
        @for (col of columns; track $index) {
        <th [ngStyle]="{'min-width': col.width}" [attr.colspan]="col.colspan" [attr.rowspan]="col.rowspan" class="grid-lines">
          {{ col.header }}
        </th>
        }
      </tr>
      <tr>
        @for (subCol of subeHeaderTable; track $index) {
          <th class="grid-lines" style="min-width: 200px">{{subCol.header}}</th>
        }

        <!-- <th style="min-width: 200px">ENTRANTE</th>
        <th style="min-width: 200px">SALIENTE</th>
        <th style="min-width: 200px">SI</th>
        <th style="min-width: 200px">NO</th>
        <th style="min-width: 200px">SI</th>
        <th style="min-width: 200px">NO</th> -->
      </tr>

    </ng-template>

    <ng-template #body let-customer>
      <tr>
        @if (editingRow === customer) {
        <td><input [(ngModel)]="customer.remite" /></td>
        <td><input [(ngModel)]="customer.nombres" /></td>
        <td><input [(ngModel)]="customer.apellidos" /></td>
        <td><input type="date" [(ngModel)]="customer.fecha_parto" /></td>
        <td><input [(ngModel)]="customer.no_doc" /></td>
        <td><input type="number" [(ngModel)]="customer.edad" /></td>
        <td><input [(ngModel)]="customer.telefono" /></td>
        <td><input [(ngModel)]="customer.barrio" /></td>
        <td><input [(ngModel)]="customer.direccion" /></td>
        <td><input [(ngModel)]="customer.educacion_presencial" /></td>
        <td><input type="date" [(ngModel)]="customer.fecha_llamada" /></td>

        <td>
          <input type="checkbox" [(ngModel)]="customer.llamada_entrante" />
        </td>
        <td>
          <input type="checkbox" [(ngModel)]="customer.llamada_saliente" />
        </td>
        <td><input [(ngModel)]="customer.responsable" /></td>

        <td>
          <input type="checkbox" [(ngModel)]="customer.recibe_asesoria_si" />
        </td>
        <td>
          <input type="checkbox" [(ngModel)]="customer.recibe_asesoria_no" />
        </td>
        <td>
          <input type="checkbox" [(ngModel)]="customer.posible_donante_si" />
        </td>
        <td>
          <input type="checkbox" [(ngModel)]="customer.posible_donante_no" />
        </td>

        <td><input type="date" [(ngModel)]="customer.fecha_visita" /></td>
        <td><input [(ngModel)]="customer.observaciones" /></td>
        <td>
          <button (click)="guardarFila()">üíæ</button>
          <button (click)="cancelarEdicion()">‚ùå</button>
        </td>
        } @else {
        <td>{{ customer.remite }}</td>
        <td>{{ customer.nombres }}</td>
        <td>{{ customer.apellidos }}</td>
        <td>{{ customer.fecha_parto }}</td>
        <td>{{ customer.no_doc }}</td>
        <td>{{ customer.edad }}</td>
        <td>{{ customer.telefono }}</td>
        <td>{{ customer.barrio }}</td>
        <td>{{ customer.direccion }}</td>
        <td>{{ customer.educacion_presencial }}</td>
        <td>{{ customer.fecha_llamada }}</td>
        <td>{{ customer.llamada_entrante ? "‚úîÔ∏è" : "" }}</td>
        <td>{{ customer.llamada_saliente ? "‚úîÔ∏è" : "" }}</td>
        <td>{{ customer.responsable }}</td>
        <td>{{ customer.recibe_asesoria_si ? "‚úîÔ∏è" : "" }}</td>
        <td>{{ customer.recibe_asesoria_no ? "‚úîÔ∏è" : "" }}</td>
        <td>{{ customer.posible_donante_si ? "‚úîÔ∏è" : "" }}</td>
        <td>{{ customer.posible_donante_no ? "‚úîÔ∏è" : "" }}</td>
        <td>{{ customer.fecha_visita }}</td>
        <td>{{ customer.observaciones }}</td>
        <td>
          <button (click)="editarFila(customer)">‚úèÔ∏è</button>
        </td>
        }
      </tr>
    </ng-template>

    <!-- <ng-template pTemplate="footer">
      <tr>
        <td style="min-width: 200px">REMITE</td>
        <td style="min-width: 200px">NOMBRES</td>
        <td style="min-width: 200px">APELLIDOS</td>
        <td style="min-width: 200px">FECHA PARTO</td>
        <td style="min-width: 200px">NO. DOC</td>
        <td style="min-width: 200px">EDAD</td>
        <td style="min-width: 200px">TELEFONO</td>
        <td style="min-width: 200px">BARRIO</td>
        <td style="min-width: 200px">DIRECCION</td>
        <td style="min-width: 200px">EDUCACION PRESENCIAL</td>
        <td style="min-width: 200px">FECHA LLAMADA</td>
        <td style="min-width: 200px">ENTRANTE</td>
        <td style="min-width: 200px">SALIENTE</td>
        <td style="min-width: 200px">RESPONSABLE</td>
        <td style="min-width: 200px">SI</td>
        <td style="min-width: 200px">NO</td>
        <td style="min-width: 200px">SI</td>
        <td style="min-width: 200px">NO</td>
        <td style="min-width: 200px">FECHA VISITA</td>
        <td style="min-width: 200px">OBSERVACIONES</td>
        <td style="min-width: 200px">ACCIONES</td>
      </tr>
    </ng-template> -->
  </p-table>
</div>